<!doctype html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Th∆∞ vi·ªán game ‚Äì OODLES MATH</title>

  <style>
    :root{
      --bg1:#edf5ff;
      --bg2:#f7fff4;
      --card: rgba(255,255,255,.86);
      --card2: rgba(255,255,255,.94);
      --border: rgba(148,163,184,.22);
      --text:#0f172a;
      --muted:#64748b;
      --accent:#2563eb;
      --accent2:#06b6d4;
      --ok:#16a34a;
      --shadow: 0 18px 45px rgba(15, 23, 42, .12);
      --shadow2: 0 10px 25px rgba(15, 23, 42, .08);
      --radius: 20px;
      --radius2: 16px;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
      color:var(--text);
      min-height:100vh;

      /* N·ªÅn nh·∫π nh∆∞ app h·ªçc */
      background:
        radial-gradient(1200px 600px at 15% 8%, rgba(37,99,235,.18), transparent 55%),
        radial-gradient(900px 500px at 85% 12%, rgba(6,182,212,.16), transparent 55%),
        radial-gradient(700px 420px at 70% 80%, rgba(34,197,94,.10), transparent 60%),
        linear-gradient(135deg, var(--bg1), var(--bg2));
    }

    /* h·ªça ti·∫øt ch·∫•m nh·∫π */
    .bg-dots{
      position: fixed;
      inset: 0;
      pointer-events: none;
      opacity: .22;
      background-image: radial-gradient(rgba(15,23,42,.16) 1px, transparent 1px);
      background-size: 18px 18px;
      mix-blend-mode: multiply;
    }

    /* ===== Header ===== */
    header{
      position: sticky;
      top:0;
      z-index:20;
      background: rgba(255,255,255,.72);
      backdrop-filter: blur(10px);
      border-bottom: 1px solid var(--border);
      padding: 14px 16px;
    }
    .head-inner{
      max-width: 1240px;
      margin: 0 auto;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
    }
    .brand{
      display:flex;
      align-items:center;
      gap:12px;
      min-width: 280px;
    }
    .brand img{
      height:38px;
      width:auto;
      filter: drop-shadow(0 6px 10px rgba(15,23,42,.12));
    }
    .brand .t{
      display:flex;
      flex-direction:column;
      line-height:1.15;
    }
    .brand .t b{font-size:16px; letter-spacing:.2px}
    .brand .t span{font-size:12px; color:var(--muted)}
    .right-hint{
      display:flex;
      align-items:center;
      gap:10px;
      flex-wrap:wrap;
      justify-content:flex-end;
    }
    .chip{
      border:1px solid var(--border);
      background: rgba(255,255,255,.78);
      border-radius: 999px;
      padding: 7px 10px;
      font-size:12px;
      color: #0f172a;
      box-shadow: var(--shadow2);
    }

    /* ===== Layout ===== */
    .wrap{
      max-width: 1240px;
      margin: 0 auto;
      padding: 16px;
      display:grid;
      grid-template-columns: 350px 1fr;
      gap: 16px;
      min-height: calc(100vh - 74px);
      position: relative;
      z-index: 1;
    }

    /* ===== Sidebar ===== */
    .sidebar{
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow:hidden;
      display:flex;
      flex-direction:column;
      min-height: 560px;
    }
    .side-top{
      padding: 12px;
      border-bottom: 1px solid var(--border);
      background: rgba(255,255,255,.55);
    }
    .search{
      width:100%;
      border: 1px solid rgba(148,163,184,.35);
      border-radius: 14px;
      padding: 10px 12px;
      font-size: 13px;
      outline:none;
      background: rgba(255,255,255,.90);
    }
    .side-meta{
      margin-top:10px;
      display:flex;
      gap:8px;
      flex-wrap:wrap;
      align-items:center;
      justify-content:space-between;
    }
    .mini{
      font-size:12px;
      color: var(--muted);
    }

    .list{
      padding: 12px;
      overflow:auto;
      height: 100%;
    }

    /* Group heading */
    .group{
      margin: 10px 2px 6px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
    }
    .group .name{
      font-size:12px;
      font-weight: 900;
      color:#0f172a;
      letter-spacing:.15px;
      display:flex;
      align-items:center;
      gap:8px;
      text-transform: uppercase;
    }
    .badge{
      font-size:11px;
      color: var(--muted);
      border: 1px solid rgba(148,163,184,.30);
      padding: 4px 8px;
      border-radius: 999px;
      background: rgba(255,255,255,.70);
    }
    .divider{
      height:1px;
      background: rgba(148,163,184,.22);
      margin: 8px 0 12px;
    }

    /* Item */
    .item{
      width:100%;
      text-align:left;
      border: 1px solid transparent;
      background: rgba(255,255,255,.80);
      border-radius: 18px;
      padding: 12px 12px;
      cursor:pointer;
      transition: .15s ease;
      margin-bottom: 10px;
      box-shadow: 0 6px 18px rgba(15,23,42,.06);
      position: relative;
      overflow:hidden;
    }
    .item:hover{
      transform: translateY(-1px);
      border-color: rgba(99,102,241,.25);
      background: rgba(255,255,255,.94);
    }
    .item.active{
      border-color: rgba(37,99,235,.40);
      background: rgba(255,255,255,.96);
      box-shadow: 0 12px 26px rgba(37,99,235,.12);
    }

    /* Icon nh·ªè b√™n tr√°i */
    .row{
      display:flex;
      align-items:center;
      gap:10px;
    }
    .ico{
      width:34px;
      height:34px;
      border-radius: 12px;
      display:grid;
      place-items:center;
      border: 1px solid rgba(148,163,184,.25);
      box-shadow: 0 10px 18px rgba(15,23,42,.08);
      flex: 0 0 34px;
      font-size: 18px;
      background: linear-gradient(135deg, rgba(37,99,235,.14), rgba(6,182,212,.10));
    }
    .item .t{
      font-weight: 900;
      font-size: 14px;
      letter-spacing: .15px;
    }
    .item .d{
      color: var(--muted);
      font-size: 12px;
      margin-top: 3px;
    }

    /* Dropdown parent */
    .item.parent{
      margin-bottom: 6px;
    }
    .chev{
      margin-left:auto;
      font-size: 14px;
      color: var(--muted);
      transform: rotate(0deg);
      transition: .15s ease;
    }
    .item.parent.expanded .chev{ transform: rotate(180deg); }

    .children{
      margin: 0 0 10px 10px;
      padding-left: 12px;
      border-left: 2px dashed rgba(148,163,184,.35);
      display:none;
    }
    .children.show{ display:block; }
    .child{
      margin-top: 8px;
      border-radius: 16px;
      padding: 10px 10px;
    }
    .child .ico{
      width:30px;height:30px;border-radius: 11px;flex:0 0 30px;font-size:16px;
      background: linear-gradient(135deg, rgba(34,197,94,.14), rgba(6,182,212,.10));
    }

    .side-foot{
      border-top: 1px solid var(--border);
      padding: 10px 12px;
      background: rgba(255,255,255,.55);
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
    }
    .side-foot .small{
      font-size:12px;
      color: var(--muted);
    }

    /* ===== Main ===== */
    .main{
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow:hidden;
      min-height: 560px;
      display:flex;
      flex-direction:column;
      position:relative;
    }
    .main-top{
      padding: 12px 14px;
      border-bottom: 1px solid var(--border);
      background: rgba(255,255,255,.55);
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 12px;
    }
    .now{
      font-weight: 950;
      font-size: 14px;
    }
    .url{
      color: var(--muted);
      font-size: 12px;
      overflow:hidden;
      text-overflow:ellipsis;
      white-space:nowrap;
      max-width: 70ch;
      margin-top:2px;
    }

    .btns{
      display:flex;
      align-items:center;
      gap: 8px;
      flex-wrap:wrap;
      justify-content:flex-end;
    }
    .btn{
      border: 1px solid rgba(148,163,184,.30);
      background: rgba(255,255,255,.86);
      border-radius: 999px;
      padding: 8px 12px;
      font-size: 12px;
      text-decoration:none;
      color: #0f172a;
      cursor:pointer;
      display:inline-flex;
      align-items:center;
      gap:8px;
      box-shadow: 0 8px 18px rgba(15,23,42,.08);
      transition:.15s;
      user-select:none;
    }
    .btn:hover{transform: translateY(-1px)}
    .btn.primary{
      border-color: rgba(37,99,235,.35);
      background: linear-gradient(135deg, rgba(37,99,235,.14), rgba(6,182,212,.12));
    }

    .stage{
      flex:1;
      padding: 14px;
      background:
        radial-gradient(900px 420px at 50% 15%, rgba(255,255,255,.60), transparent 60%),
        linear-gradient(135deg, rgba(255,255,255,.22), rgba(255,255,255,.10));
    }

    .frame-wrap{
      height:100%;
      background: var(--card2);
      border: 1px solid rgba(148,163,184,.20);
      border-radius: 18px;
      padding: 12px;
      box-shadow: 0 14px 40px rgba(15,23,42,.10);
      position:relative;
      overflow:hidden;
    }

    /* watermark logo nh·∫π ·ªü khung game */
    .wm{
      position:absolute;
      top: 14px;
      right: 14px;
      opacity: .22;
      width: 120px;
      height:auto;
      pointer-events:none;
      filter: grayscale(10%);
    }

    .empty{
      height:100%;
      display:grid;
      place-items:center;
      text-align:center;
      color: var(--muted);
      font-size: 14px;
      padding: 30px;
    }
    .empty b{color:#0f172a}
    .empty .sub{margin-top:8px; font-size:12px}

    iframe{
      width:100%;
      height: calc(100vh - 74px - 16px - 16px - 54px - 28px - 26px);
      min-height: 540px;
      border:0;
      border-radius: 14px;
      background:#fff;
    }

    /* ===== Responsive ===== */
    @media (max-width: 980px){
      .wrap{grid-template-columns: 1fr}
      .brand .t span{display:none}
      iframe{height: 72vh; min-height: 420px;}
    }
  </style>
</head>

<body>
  <div class="bg-dots"></div>

  <header>
    <div class="head-inner">
      <div class="brand">
        <img src="assets/logo-oodles-math.png" alt="OODLES MATH">
        <div class="t">
          <b>Th∆∞ vi·ªán game</b>
          <span>To√°n t∆∞ duy, tr√≠ tu·ªá thƒÉng hoa</span>
        </div>
      </div>

      <div class="right-hint">
        <div id="countChip" class="chip">üìö 0 game</div>
        <div class="chip">‚ú® Tip: Ctrl + F5 n·∫øu v·ª´a update</div>
      </div>
    </div>
  </header>

  <div class="wrap">
    <!-- Sidebar -->
    <aside class="sidebar">
      <div class="side-top">
        <input id="q" class="search" placeholder="T√¨m lesson‚Ä¶ (vd: 05, Seeker B, animal‚Ä¶)" />
        <div class="side-meta">
          <div id="miniText" class="mini">G√µ ƒë·ªÉ l·ªçc nhanh</div>
          <div class="chip" style="box-shadow:none;">üéÆ Play</div>
        </div>
      </div>

      <div id="gameList" class="list"></div>

      <div class="side-foot">
        <div class="small">OODLES MATH ‚Ä¢ GitHub Pages</div>
        <a class="btn" href="https://github.com/AbelHoangLoc/Abel_math_games" target="_blank" rel="noopener"></a>
      </div>
    </aside>

    <!-- Main -->
    <main class="main">
      <div class="main-top">
        <div>
          <div id="nowTitle" class="now">Ch∆∞a ch·ªçn game</div>
          <div id="nowUrl" class="url"></div>
        </div>

        <div class="btns">
          <a id="openBtn" class="btn primary" href="#" target="_blank" rel="noopener" style="display:none;">‚Üó Open</a>
          <button id="copyBtn" class="btn" style="display:none;">üìã Copy link</button>
        </div>
      </div>

      <div class="stage">
        <div class="frame-wrap">
          <img class="wm" src="assets/logo-oodles-math.png" alt="">
          <div id="emptyState" class="empty">
            <div>
              <b>Ch·ªçn 1 lesson ·ªü menu b√™n tr√°i</b> ƒë·ªÉ b·∫Øt ƒë·∫ßu ch∆°i üéØ
              <div class="sub">Lesson 05 c√≥ dropdown ƒë·ªÉ ch·ªçn Game A / Game B</div>
            </div>
          </div>
          <iframe id="gameFrame" title="Math Game" style="display:none;"></iframe>
        </div>
      </div>
    </main>
  </div>

  <script>
    /* ========= CONFIG =========
      - Group: Seeker A / Seeker B / Thinking Math
      - Dropdown: Lesson 05 (A/B)
      - Icon t·ª´ng lesson: emoji
      - url: th∆∞ m·ª•c con, v√≠ d·ª• "lesson-01/"
    */

    const groups = [
      {
        id: "seeker-b",
        name: "Seeker B",
        icon: "üü¶",
        items: [
          { id:"lesson-01", title:"Lesson 01", desc:"Seeker B ‚Ä¢ Lesson 01", icon:"üê∏", url:"lesson-01/" },
          { id:"lesson-02", title:"Lesson 02", desc:"Seeker B ‚Ä¢ Lesson 02", icon:"üêº", url:"lesson-02/" },
          { id:"lesson-03", title:"Lesson 03", desc:"Seeker B ‚Ä¢ Lesson 03", icon:"ü¶ä", url:"lesson-03/" },
          { id:"lesson-04", title:"Lesson 04", desc:"Seeker B ‚Ä¢ Lesson 04", icon:"üçí", url:"lesson-04/" },

          // ‚úÖ Dropdown Lesson 05
          {
            id:"lesson-05",
            title:"Lesson 05",
            desc:"Seeker B ‚Ä¢ Lesson 05 (2 game)",
            icon:"üéØ",
            children: [
              { id:"lesson-05-a", title:"Lesson 05 ‚Äì Game A", desc:"Seeker B ‚Ä¢ Lesson 05", icon:"üÖ∞Ô∏è", url:"lesson-05-game-1/" },
              { id:"lesson-05-b", title:"Lesson 05 ‚Äì Game B", desc:"Seeker B ‚Ä¢ Lesson 05", icon:"üÖ±Ô∏è", url:"lesson-05-game-2/" },
            ]
          },

          { id:"lesson-06", title:"Lesson 06", desc:"Seeker B ‚Ä¢ Lesson 06", icon:"üß©", url:"lesson-06/" },
          { id:"lesson-07", title:"Lesson 07", desc:"Seeker B ‚Ä¢ Lesson 07", icon:"üê±", url:"lesson-07/" },
          { id:"lesson-08", title:"Lesson 08", desc:"Seeker B ‚Ä¢ Lesson 08", icon:"ü¶Å", url:"lesson-08/" },
          { id:"lesson-09", title:"Lesson 09", desc:"Seeker B ‚Ä¢ Lesson 09", icon:"ü¶Ñ", url:"lesson-09/" },
          { id:"lesson-10", title:"Lesson 10", desc:"Seeker B ‚Ä¢ Lesson 10", icon:"üéà", url:"lesson-10/" },
          { id:"lesson-11", title:"Lesson 11", desc:"Seeker B ‚Ä¢ Lesson 11", icon:"üöÄ", url:"lesson-11/" },
          { id:"lesson-12", title:"Lesson 12", desc:"Seeker B ‚Ä¢ Lesson 12", icon:"üçì", url:"lesson-12/" },
          { id:"lesson-13", title:"Lesson 13", desc:"Seeker B ‚Ä¢ Lesson 13", icon:"üçâ", url:"lesson-13/" },
          { id:"lesson-14", title:"Lesson 14", desc:"Seeker B ‚Ä¢ Lesson 14", icon:"üçá", url:"lesson-14/" },
          { id:"lesson-15", title:"Lesson 15", desc:"Seeker B ‚Ä¢ Lesson 15", icon:"üé≤", url:"lesson-15/" },
          { id:"lesson-16", title:"Lesson 16", desc:"Seeker B ‚Ä¢ Lesson 16", icon:"üß†", url:"lesson-16/" },
        ]
      },

      /* B·∫°n ch∆∞a c√≥ Seeker A/Thinking Math th√¨ ƒë·ªÉ tr·ªëng, sau n√†y th√™m item v√†o l√† t·ª± hi·ªán */
      {
        id: "seeker-a",
        name: "Seeker A",
        icon: "üü©",
        items: [
          // v√≠ d·ª•:
          // { id:"sa-01", title:"Lesson 01", desc:"Seeker A ‚Ä¢ Lesson 01", icon:"üê∞", url:"seeker-a/lesson-01/" },
        ]
      },
      {
        id: "thinking-math",
        name: "Thinking Math",
        icon: "üü™",
        items: [
          // v√≠ d·ª•:
          // { id:"tm-01", title:"Skill 01", desc:"Thinking Math ‚Ä¢ Skill 01", icon:"üßÆ", url:"thinking-math/skill-01/" },
        ]
      }
    ];

    // ====== Elements ======
    const listEl = document.getElementById("gameList");
    const frame = document.getElementById("gameFrame");
    const empty = document.getElementById("emptyState");
    const nowTitle = document.getElementById("nowTitle");
    const nowUrl = document.getElementById("nowUrl");
    const openBtn = document.getElementById("openBtn");
    const copyBtn = document.getElementById("copyBtn");
    const search = document.getElementById("q");
    const countChip = document.getElementById("countChip");
    const miniText = document.getElementById("miniText");

    const base = location.origin + location.pathname.replace(/index\.html$/,"");

    const flatten = () => {
      const out = [];
      groups.forEach(g => {
        g.items.forEach(it => {
          if(it.children){
            it.children.forEach(ch => out.push({ ...ch, group:g.name }));
          } else {
            out.push({ ...it, group:g.name });
          }
        });
      });
      return out;
    };

    const allGames = flatten();
    countChip.textContent = `üìö ${allGames.length} game`;

    function directLink(url){ return base + url; }
    function openLink(gameId){ return base + `?game=${encodeURIComponent(gameId)}`; }

    function setActive(id){
      document.querySelectorAll(".item,.child").forEach(x => x.classList.remove("active"));
      const target = document.querySelector(`[data-id="${id}"]`);
      if(target) target.classList.add("active");
    }

    function ensureParentExpanded(childId){
      const parent = document.querySelector(`[data-child="${childId}"]`);
      if(parent){
        const childrenBox = parent.nextElementSibling;
        if(childrenBox && childrenBox.classList.contains("children")){
          childrenBox.classList.add("show");
          parent.classList.add("expanded");
        }
      }
    }

    function selectGame(game){
      empty.style.display = "none";
      frame.style.display = "block";
      frame.src = game.url;

      nowTitle.textContent = `${game.title}`;
      nowUrl.textContent = directLink(game.url);

      openBtn.style.display = "inline-flex";
      openBtn.href = directLink(game.url);

      copyBtn.style.display = "inline-flex";
      copyBtn.onclick = async () => {
        const link = openLink(game.id);
        try{
          await navigator.clipboard.writeText(link);
          copyBtn.textContent = "‚úÖ Copied";
          setTimeout(()=>copyBtn.textContent="üìã Copy link", 900);
        }catch(e){
          prompt("Copy link:", link);
        }
      };

      // update URL param
      const u = new URL(location.href);
      u.searchParams.set("game", game.id);
      history.replaceState(null,"",u.toString());

      ensureParentExpanded(game.id);
      setActive(game.id);
    }

    function render(filterText=""){
      const q = filterText.trim().toLowerCase();

      listEl.innerHTML = "";
      let shownCount = 0;

      groups.forEach(group => {
        // l·ªçc items theo search
        const items = group.items.filter(it => {
          if(!q) return true;

          if(it.children){
            // match parent OR any child
            const parentText = `${it.title} ${it.desc} ${it.id}`.toLowerCase();
            const anyChild = it.children.some(ch =>
              (`${ch.title} ${ch.desc} ${ch.id} ${ch.url}`).toLowerCase().includes(q)
            );
            return parentText.includes(q) || anyChild;
          }

          return (`${it.title} ${it.desc} ${it.id} ${it.url}`).toLowerCase().includes(q);
        });

        if(items.length === 0) return;

        // group header
        const head = document.createElement("div");
        head.className = "group";
        const totalInGroup = group.items.reduce((acc,it)=> acc + (it.children ? it.children.length : 1), 0);
        head.innerHTML = `
          <div class="name">${group.icon} ${group.name}</div>
          <div class="badge">${totalInGroup} game</div>
        `;
        listEl.appendChild(head);
        listEl.appendChild(Object.assign(document.createElement("div"), { className:"divider" }));

        items.forEach(it => {
          if(it.children){
            // Parent row
            const parentBtn = document.createElement("button");
            parentBtn.className = "item parent";
            parentBtn.setAttribute("data-child", it.children[0].id); // gi√∫p auto m·ªü dropdown khi m·ªü game con
            parentBtn.innerHTML = `
              <div class="row">
                <div class="ico">${it.icon || "üìö"}</div>
                <div style="min-width:0">
                  <div class="t">${it.title} <span style="color:var(--muted);font-weight:800">‚Ä¢ Dropdown</span></div>
                  <div class="d">${it.desc}</div>
                </div>
                <div class="chev">‚ñæ</div>
              </div>
            `;
            listEl.appendChild(parentBtn);

            // Children container
            const childrenBox = document.createElement("div");
            childrenBox.className = "children";
            it.children.forEach(ch => {
              // hide child if search doesn't match
              if(q){
                const txt = (`${ch.title} ${ch.desc} ${ch.id} ${ch.url}`).toLowerCase();
                if(!txt.includes(q)) return;
              }

              const childBtn = document.createElement("button");
              childBtn.className = "item child";
              childBtn.setAttribute("data-id", ch.id);
              childBtn.innerHTML = `
                <div class="row">
                  <div class="ico">${ch.icon || "üéÆ"}</div>
                  <div style="min-width:0">
                    <div class="t">${ch.title}</div>
                    <div class="d">${ch.desc}</div>
                  </div>
                </div>
              `;
              childBtn.onclick = () => selectGame(ch);
              childrenBox.appendChild(childBtn);
              shownCount++;
            });

            listEl.appendChild(childrenBox);

            // Toggle dropdown
            parentBtn.onclick = () => {
              const isOpen = childrenBox.classList.contains("show");
              document.querySelectorAll(".children").forEach(box => box.classList.remove("show"));
              document.querySelectorAll(".item.parent").forEach(b => b.classList.remove("expanded"));

              if(!isOpen){
                childrenBox.classList.add("show");
                parentBtn.classList.add("expanded");
              }
            };

          } else {
            const btn = document.createElement("button");
            btn.className = "item";
            btn.setAttribute("data-id", it.id);
            btn.innerHTML = `
              <div class="row">
                <div class="ico">${it.icon || "üéÆ"}</div>
                <div style="min-width:0">
                  <div class="t">${it.title}</div>
                  <div class="d">${it.desc}</div>
                </div>
              </div>
            `;
            btn.onclick = () => selectGame(it);
            listEl.appendChild(btn);
            shownCount++;
          }
        });
      });

      miniText.textContent = q ? `ƒêang hi·ªÉn th·ªã ${shownCount} m·ª•c theo t·ª´ kh√≥a` : "G√µ ƒë·ªÉ l·ªçc nhanh";
    }

    // Search
    search.addEventListener("input", () => render(search.value));

    // Init
    render("");

    // Auto open by ?game=
    const params = new URLSearchParams(location.search);
    const gid = params.get("game");
    if(gid){
      const found = allGames.find(x => x.id === gid);
      if(found){
        selectGame(found);
      }
    }
  </script>
</body>
</html>
